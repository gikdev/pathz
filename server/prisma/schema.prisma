// https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = env("DB_URL")
}

model CurriculumStep {
  id        Int      @id @default(autoincrement())
  // ---
  position  Int
  // ---
  lessonId  Int      @unique
  lesson    Lesson   @relation(fields: [lessonId], references: [id])
  // ---
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Lesson {
  id             Int             @id @default(autoincrement())
  // ---
  title          String
  // ---
  course         Course          @relation(fields: [courseId], references: [id])
  courseId       Int
  curriculumStep CurriculumStep?
  pieces         Piece[]
  // ---
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
}

model Course {
  id          Int      @id @default(autoincrement())
  // ---
  title       String
  description String?
  // ---
  lessons     Lesson[]
  // ---
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Piece {
  id        Int       @id @default(autoincrement())
  // ---
  type      PieceType
  payload   String?
  position  Int
  // ---
  lesson    Lesson    @relation(fields: [lessonId], references: [id])
  lessonId  Int
  // ---
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

enum PieceType {
  Text
  Video
  Audio
  Separator
  Image
}
